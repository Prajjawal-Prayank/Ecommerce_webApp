{"ast":null,"code":"var _jsxFileName = \"D:\\\\B Tech\\\\WebD\\\\ecommerce-frontend\\\\src\\\\admin\\\\UpdateProduct.js\";\nimport React, { useState, useEffect } from \"react\";\nimport Layout from '../core/Layout';\nimport { isAuthenticated } from '../auth';\nimport { Redirect } from 'react-router-dom';\nimport { getProduct, getCategories, updateProduct } from './apiAdmin';\n\nconst UpdateProduct = ({\n  match\n}) => {\n  const {\n    user,\n    token\n  } = isAuthenticated();\n  const [values, setValues] = useState({\n    name: '',\n    description: '',\n    price: '',\n    categories: [],\n    category: '',\n    shipping: '',\n    quantity: '',\n    photo: '',\n    loading: false,\n    error: '',\n    createdProduct: '',\n    redirectToProfile: false,\n    //formData: ''    //we will send this to the backend\n    formData: new FormData()\n  });\n  const {\n    name,\n    description,\n    price,\n    category,\n    shipping,\n    categories,\n    quantity,\n    loading,\n    error,\n    createdProduct,\n    redirectToProfile,\n    formData\n  } = values;\n\n  const init = productId => {\n    getProduct(productId).then(data => {\n      console.log(data);\n\n      if (data.error) {\n        setValues({ ...values,\n          error: data.error\n        });\n      } else {\n        //here we will populate the state and load categories\n        setValues({ ...values,\n          name: data.name,\n          description: data.description,\n          price: data.price,\n          quantity: data.quantity,\n          //category:data.category._id,\n          shipping: data.shipping,\n          formData: new formData()\n        });\n        initCategories();\n      }\n    });\n  }; //load categories and set form data\n\n\n  const initCategories = () => {\n    getCategories().then(data => {\n      if (data.error) {\n        setValues({ ...values,\n          error: data.error\n        });\n      } else {\n        setValues({\n          categories: data,\n          formData: new FormData()\n        });\n      }\n    });\n  };\n\n  useEffect(() => {\n    init(match.params.productId);\n  }, []);\n\n  const handleChange = name => event => {\n    const value = name === 'photo' ? event.target.files[0] : event.target.value; //event.target.files[0]-> only first image is considered.In multiple uploads, we are only\n    //considering the first image\n\n    formData.set(name, value);\n    setValues({ ...values,\n      [name]: value\n    });\n  };\n\n  const clickSubmit = event => {\n    event.preventDefault();\n    setValues({ ...values,\n      error: '',\n      loading: true\n    });\n    updateProduct(match.params.productId, user._id, token, formData).then(data => {\n      if (data.error) {\n        setValues({ ...values,\n          error: data.error\n        });\n      } else {\n        setValues({ ...values,\n          name: '',\n          description: '',\n          price: '',\n          photo: '',\n          loading: false,\n          quantity: '',\n          category: '',\n          createdProduct: data.name\n        }); //document.getElementById(\"all_cat\").selectedIndex = \"0\";\n        //  document.getElementById(\"ship_status\").selectedIndex = \"0\";\n      }\n    });\n  };\n\n  const newProductForm = () => /*#__PURE__*/React.createElement(\"form\", {\n    className: \"mb-3\",\n    onSubmit: clickSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 13\n    }\n  }, \"Attach Photo\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    className: \"btn btn-secondary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    onChange: handleChange('photo'),\n    type: \"file\",\n    name: \"photo\",\n    accept: \"image/*\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 21\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    className: \"text-muted\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 17\n    }\n  }, \"Name\"), /*#__PURE__*/React.createElement(\"input\", {\n    onChange: handleChange('name'),\n    type: \"text\",\n    className: \"form-control\",\n    value: name,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    className: \"text-muted\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 17\n    }\n  }, \"Description\"), /*#__PURE__*/React.createElement(\"textarea\", {\n    onChange: handleChange('description'),\n    className: \"form-control\",\n    value: description,\n    style: {\n      whiteSpace: 'pre'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    className: \"text-muted\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 17\n    }\n  }, \"Price\"), /*#__PURE__*/React.createElement(\"input\", {\n    onChange: handleChange('price'),\n    type: \"number\",\n    className: \"form-control\",\n    value: price,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    className: \"text-muted\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 17\n    }\n  }, \"Category \"), /*#__PURE__*/React.createElement(\"select\", {\n    onChange: handleChange('category'),\n    className: \"form-control\",\n    id: \"all_cat\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 17\n    }\n  }, \"Please Select\"), categories && categories.map((c, idx) => /*#__PURE__*/React.createElement(\"option\", {\n    key: idx,\n    value: c._id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 25\n    }\n  }, c.name)))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    className: \"text-muted\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 17\n    }\n  }, \"Shipping\"), /*#__PURE__*/React.createElement(\"select\", {\n    onChange: handleChange('shipping'),\n    className: \"form-control\",\n    id: \"ship_status\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 21\n    }\n  }, \"Please Select\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 21\n    }\n  }, \"No\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 21\n    }\n  }, \"Yes\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    className: \"text-muted\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 17\n    }\n  }, \"Quantity\"), /*#__PURE__*/React.createElement(\"input\", {\n    onChange: handleChange('quantity'),\n    type: \"number\",\n    className: \"form-control\",\n    value: quantity,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-outline-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 13\n    }\n  }, \"Update Product\"));\n\n  const showError = () => /*#__PURE__*/React.createElement(\"div\", {\n    className: \"alert alert-danger\",\n    style: {\n      display: error ? '' : 'none'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 9\n    }\n  }, error);\n\n  const showSuccess = () => /*#__PURE__*/React.createElement(\"div\", {\n    className: \"alert alert-info\",\n    style: {\n      display: createdProduct ? '' : 'none'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 13\n    }\n  }, \"Product \\\"\", `${createdProduct} `, \"\\\" is updated!\"));\n\n  const showLoading = () => loading && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"alert alert-success\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 20\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 13\n    }\n  }, \"Loading...\"));\n\n  const redirectUser = () => {\n    if (redirectToProfile) {\n      if (!err) {\n        return /*#__PURE__*/React.createElement(Redirect, {\n          to: \"/\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 24\n          }\n        });\n      }\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(Layout, {\n    title: \"Add a new Product\",\n    description: `Welcome ${user.name}!`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-8 offset-md-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 17\n    }\n  }, showLoading(), showSuccess(), showError(), newProductForm(), redirectUser())));\n};\n\nexport default UpdateProduct; //style={{'whiteSpace': 'pre-line'}}\n\n/*\r\n{\r\n\r\nvar result = Object.keys(data).map(function (key) { \r\n    return [Number(key), data[key]]; \r\n});  \r\n\r\nif(data.error){\r\n    setValues({...values,error:data.error});\r\n}else{\r\n    setValues({...values,\r\n        name:'',\r\n        description:'',\r\n        price:'',\r\n        photo:'',\r\n        loading:false,\r\n        quantity:'',\r\n        category:'',\r\n        createdProduct: result[0][1].name\r\n    });\r\n    document.getElementById(\"all_cat\").selectedIndex = \"0\";\r\n    document.getElementById(\"ship_status\").selectedIndex = \"0\";\r\n}\r\n*/","map":{"version":3,"sources":["D:/B Tech/WebD/ecommerce-frontend/src/admin/UpdateProduct.js"],"names":["React","useState","useEffect","Layout","isAuthenticated","Redirect","getProduct","getCategories","updateProduct","UpdateProduct","match","user","token","values","setValues","name","description","price","categories","category","shipping","quantity","photo","loading","error","createdProduct","redirectToProfile","formData","FormData","init","productId","then","data","console","log","initCategories","params","handleChange","event","value","target","files","set","clickSubmit","preventDefault","_id","newProductForm","whiteSpace","map","c","idx","showError","display","showSuccess","showLoading","redirectUser","err"],"mappings":"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","sourcesContent":["import React,{useState,useEffect} from \"react\";\r\nimport Layout from '../core/Layout';\r\nimport {isAuthenticated} from '../auth';\r\nimport {Redirect} from 'react-router-dom';\r\nimport {getProduct,getCategories,updateProduct} from './apiAdmin';\r\n\r\nconst UpdateProduct=({match})=>{\r\n\r\n    const {user,token} = isAuthenticated();\r\n    const [values,setValues]=useState({\r\n        name:'',\r\n        description:'',\r\n        price:'',\r\n        categories:[],\r\n        category:'',\r\n        shipping:'',\r\n        quantity:'',\r\n        photo:'',\r\n        loading:false,\r\n        error:'',\r\n        createdProduct:'',\r\n        redirectToProfile: false,\r\n        //formData: ''    //we will send this to the backend\r\n        formData:new FormData()\r\n    });\r\n\r\n    const {name,description,price,category,shipping,categories,quantity,loading,error,createdProduct,\r\n        redirectToProfile,formData} = values;   \r\n        \r\n    const init=productId=>{\r\n        getProduct(productId)\r\n            .then(data=>{   console.log(data);\r\n                if(data.error){\r\n                    setValues({...values,error:data.error});\r\n                }else{\r\n                    //here we will populate the state and load categories\r\n                    setValues({...values,\r\n                        name:data.name,\r\n                        description:data.description,\r\n                        price:data.price,\r\n                        quantity:data.quantity,\r\n                        //category:data.category._id,\r\n                        shipping:data.shipping,\r\n                        formData:new formData()\r\n                    });\r\n                    initCategories();\r\n                }\r\n            })\r\n    }    \r\n\r\n\r\n    //load categories and set form data\r\n    const initCategories=()=>{\r\n        getCategories()\r\n        .then(data=>{\r\n            if(data.error){\r\n                setValues({...values,error: data.error})\r\n            }else{ \r\n                setValues({categories:data,formData:new FormData()});   \r\n            }\r\n        })\r\n    };\r\n\r\n\r\n    useEffect(()=>{\r\n        init(match.params.productId);\r\n    },[]);\r\n\r\n    const handleChange=name=>event=>{\r\n        const value= (name==='photo'? event.target.files[0] : event.target.value );\r\n            //event.target.files[0]-> only first image is considered.In multiple uploads, we are only\r\n            //considering the first image\r\n        formData.set(name,value);\r\n        setValues({...values,[name]:value});    \r\n    };    \r\n\r\n\r\n    const clickSubmit=(event)=>{\r\n        event.preventDefault();\r\n        setValues({...values,error:'',loading:true});\r\n        updateProduct(match.params.productId,user._id,token,formData)\r\n        .then(data=>{\r\n            if(data.error){\r\n                setValues({...values,error:data.error});\r\n            }else{\r\n                setValues({...values,\r\n                    name:'',\r\n                    description:'',\r\n                    price:'',\r\n                    photo:'',\r\n                    loading:false,\r\n                    quantity:'',\r\n                    category:'',\r\n                    createdProduct: data.name\r\n                });\r\n                //document.getElementById(\"all_cat\").selectedIndex = \"0\";\r\n                //  document.getElementById(\"ship_status\").selectedIndex = \"0\";\r\n            }\r\n        });\r\n    };\r\n\r\n    \r\n\r\n    const newProductForm=()=>(\r\n        <form className=\"mb-3\" onSubmit={clickSubmit}>\r\n            <h4>Attach Photo</h4>\r\n            <div className=\"form-group\">\r\n                <label className=\"btn btn-secondary\"> \r\n                    <input onChange={handleChange('photo')}  type=\"file\" name=\"photo\" accept=\"image/*\" />\r\n                </label>\r\n            </div>\r\n            <div className=\"form-group\">\r\n                <label className=\"text-muted\">Name</label>\r\n                <input onChange={handleChange('name')} type=\"text\" className=\"form-control\" value={name} />                \r\n            </div>\r\n            <div className=\"form-group\">\r\n                <label className=\"text-muted\">Description</label>\r\n                <textarea onChange={handleChange('description')} className=\"form-control\" \r\n                    value={description}  style={{whiteSpace: 'pre'}} />                \r\n            </div>\r\n            <div className=\"form-group\">\r\n                <label className=\"text-muted\">Price</label>\r\n                <input onChange={handleChange('price')} type=\"number\" className=\"form-control\" value={price} />                \r\n            </div>\r\n            <div className=\"form-group\">\r\n                <label className=\"text-muted\">Category </label>\r\n                <select onChange={handleChange('category')} className=\"form-control\" id=\"all_cat\">\r\n                <option >Please Select</option>\r\n                    {categories && categories.map((c,idx)=>(\r\n                        <option key={idx} value={c._id}>{c.name}</option>))}\r\n                </select>\r\n            </div>\r\n            <div className=\"form-group\">\r\n                <label className=\"text-muted\">Shipping</label>\r\n                <select onChange={handleChange('shipping')} className=\"form-control\" id=\"ship_status\">\r\n                    <option>Please Select</option>\r\n                    <option value=\"0\">No</option>\r\n                    <option value=\"1\">Yes</option>\r\n                </select>\r\n            </div>\r\n            <div className=\"form-group\">\r\n                <label className=\"text-muted\">Quantity</label>\r\n                <input onChange={handleChange('quantity')} type=\"number\" className=\"form-control\" value={quantity} />                \r\n            </div>\r\n            <button className=\"btn btn-outline-primary\">Update Product</button>\r\n        </form>\r\n    )    \r\n\r\n    const showError=()=>(\r\n        <div className=\"alert alert-danger\" style={{display:error?'' : 'none'}}>\r\n            {error}\r\n        </div>\r\n    );\r\n\r\n    const showSuccess=()=>(\r\n        <div className=\"alert alert-info\" style={{display:createdProduct?'' : 'none'}}>\r\n            <h2>Product \"{ `${createdProduct} ` }\" is updated!</h2>\r\n        </div>\r\n    );\r\n\r\n    const showLoading=()=>(\r\n        loading && <div className=\"alert alert-success\">\r\n            <h2>Loading...</h2>\r\n        </div>\r\n    )\r\n\r\n    const redirectUser=()=>{\r\n        if(redirectToProfile){\r\n            if(!err){\r\n                return <Redirect to=\"/\" />\r\n            }\r\n        }\r\n    }\r\n\r\n    return (\r\n        <Layout title=\"Add a new Product\" description={`Welcome ${user.name}!`} >\r\n            <div className=\"row\">\r\n                <div className=\"col-md-8 offset-md-2\"> \r\n                    {showLoading()} \r\n                    {showSuccess()} \r\n                    {showError()}\r\n                    {newProductForm()}  \r\n                    {redirectUser()}                  \r\n                </div>\r\n            </div>\r\n        </Layout>\r\n    )\r\n}\r\n\r\n\r\nexport default UpdateProduct;\r\n//style={{'whiteSpace': 'pre-line'}}\r\n\r\n/*\r\n{\r\n\r\nvar result = Object.keys(data).map(function (key) { \r\n    return [Number(key), data[key]]; \r\n});  \r\n\r\nif(data.error){\r\n    setValues({...values,error:data.error});\r\n}else{\r\n    setValues({...values,\r\n        name:'',\r\n        description:'',\r\n        price:'',\r\n        photo:'',\r\n        loading:false,\r\n        quantity:'',\r\n        category:'',\r\n        createdProduct: result[0][1].name\r\n    });\r\n    document.getElementById(\"all_cat\").selectedIndex = \"0\";\r\n    document.getElementById(\"ship_status\").selectedIndex = \"0\";\r\n}\r\n*/"]},"metadata":{},"sourceType":"module"}